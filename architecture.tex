% !TEX root = ./arock_pkg_main.tex
\section{Architecture}

The toolbox can be broken into different layers. 
The layering is enforced through the usage of Interfaces.
Interfaces are a list of member functions guaranteed to exist in an object.
An Interface decouples the usage of the object from the implementation of the object. 

\subsection{Drivers}

As seen in Section~\ref{sec:quick_start}, the \pkg~driver, takes as input, a solver object, and a parameters object.
The parameter object determines the how coordinate are chosen, how many iterations to run the solver, and the stepsizes associated with the solver.
Coordinate choices include *list*.
The paremeter object also determines the multicore functionality. 
Based upon the parameter object, \pkg~launches worker threads, threads that interact with the solver object, and a controller thread, a thread that manages the worker threads.
  

\subsection{Kernel}

For each type of coordinate choice, there is a corresponding worker thread.
A worker thread iteratively chooses an index, and, using a scheme object, computes a coordinate update.
The controller thread manages the worker threads by choosing stepsizes to accelerate convergence.
The controller thread monitors convergence by maintaining an approximate fixed point residual.

\subsection{Schemes}
Schemes are objects with, at minimum, member functions as defined by the scheme interface.
insert link to interface.
Kernel and Driver interact with schemes through the scheme interface.

Constructing as scheme object is shown in example blank line blank.
Schemes are constructed from operator objects, and a solution variable.
The operator objects are used to define the coordinate update of the scheme.
By providing a coordinate to the scheme object, a coordinate update is applied to the solution variable.


\subsection{Operators}

Operators are objects with, at minimum, member functions as defined by the Operator Interface.
inert link to interface.
Schemes interact with Operator objects through the Operator Interface.

Constructing an Operator object is shown in example blank line blank.
For example, to compute the forward gradient of logisitic loss *reference equation* require the matrix A, and to maintain computational efficiency the cached variable Ax (See CFU for why Ax is stored). Note that data is passed by pointer into operator objects to prevent unnecessary copying of objects.  
Operators, to allow for different data respresentation are templatized.

\subsection{Data}

Data is represented as either sparse or dense matrices and vectors.
We use Eigen package to represent sparse matrices and vectors. 
Sparse linear algebra is provided through an interface to Eigen.
Dense linear algebra is provided through an interface to BLAS. 





